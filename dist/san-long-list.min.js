!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("san")):"function"==typeof define&&define.amd?define(["san"],e):t.LongList=e(t.san)}(this,function(t){"use strict";return t.defineComponent({template:'\n        <template>\n            <div s-ref="scroller" class="{{lClass}}" style="{{wStyle}}" on-scroll="onScroll" on-wheel="onWheel">\n                <div style="{{iStyle}}" class="{{iClass}}">\n                    <slot s-for="i in curds" var-item="{{i}}"/>\n                </div>\n            </div>\n        </template>',onScroll:function(t){if(this.data.get("enable")){var e=t.target.scrollTop,a=this.data.get(),s=a.size,r=a.buffer,i=this.data.get("cache")||0;if(!(Math.abs(i-e)<=r*s)){var o=e%s,l=Math.floor(e/s);this.data.set("cache",e),this.update(l,o)}}},update:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=this.data.get(),s=a.datasource,r=a.radius,i=a.keeps,o=a.size;i="number"==typeof i?i:0;for(var l=[],n=t-r;n<t+r-i;n++)n<0||n>=s.length||l.push(s[n]);this.data.set("curds",l);var d=(t-(r+1))*o+e,h={"padding-top":d+"px","padding-bottom":s.length*o-d-(2*r-i)*o+"px"};this.data.merge("iStyle",h)},inited:function(){var e=this;this.watch("datasource",function(t){return e.onDatasourceUpdate(t)}),this.watch("lStyle",function(t){return e.data.merge("wStyle",t)});var t=this.data.get("lStyle");this.data.merge("wStyle",t)},onDatasourceUpdate:function(t){this.ref("scroller").scrollTop=0;var e=this.data.get("threshold");t.length<=e?(this.data.set("curds",t),this.data.merge("iStyle",{"padding-top":0,"padding-bottom":0}),this.data.set("enable",!1)):(this.data.set("enable",!0),this.update(0,0))},initData:function(){return{datasource:[],curds:[],keeps:5,radius:30,buffer:4,wStyle:{"overflow-y":"scroll"},fixHeight:null,stopScroll:!0,iStyle:{},threshold:300,lHeight:function(t,e,a){return"300px"},enable:!0}},dataTypes:{stopScroll:t.DataTypes.bool,keeps:t.DataTypes.number,radius:t.DataTypes.number,buffer:t.DataTypes.number,size:t.DataTypes.number.isRequired,lHeight:t.DataTypes.objectOf(t.DataTypes.function),lStyle:t.DataTypes.object,lClass:t.DataTypes.array,iStyle:t.DataTypes.object,iClass:t.DataTypes.array,threshold:t.DataTypes.number},attached:function(){var t=this.data.get(),e=t.threshold,a=t.buffer,s=t.datasource;e||this.data.set("threshold",2*a+1),this.onDatasourceUpdate(s)},onWheel:function(t){if(this.data.get("stopScroll")){var e=t.currentTarget;e&&(e.scrollTop+t.deltaY+e.clientHeight>=e.scrollHeight&&(t.preventDefault(),e.scrollTop=e.scrollHeight),e.scrollTop+t.deltaY<=0&&(t.preventDefault(),e.scrollTop=0))}},computed:{"wStyle.height":function(){var t=this.data.get("keeps"),e=this.data.get("size"),a=this.data.get("datasource").length,s=this.data.get("lHeight");if("function"!=typeof s)throw new TypeError("(from LongList)lHeight should be a function.");return s(t,a,e)}}})});
